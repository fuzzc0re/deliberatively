(this.webpackJsonpdeliberatively=this.webpackJsonpdeliberatively||[]).push([[4],{575:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return i}));var r,i,a=n(27),u=new a.d("A1PS1vg9pR86X2NnS8EmBsb3z6mekL6myZ2XNXpGuzYp");e.from("deliberatively","utf8"),new a.d("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL");!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.VoteMarket=1]="VoteMarket",e[e.VoteParticipant=2]="VoteParticipant",e[e.VoteAlternative=3]="VoteAlternative"}(r||(r={})),function(e){e[e.InitVoteMarket=0]="InitVoteMarket"}(i||(i={}))}).call(this,n(11).Buffer)},583:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o}));var r=n(2),i=n.n(r),a=n(7),u=n(574),c=n(27),s=n(575),o=function(){var t=Object(a.a)(i.a.mark((function t(n,r){var a,o,m,b,p,l,d,f,O,v,x,y,g,P;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n.getBalance(r);case 3:if(a=t.sent,console.log("Address "+r.toBase58()+" has balance "+a),!(a<c.c)){t.next=16;break}return console.log("Airdrop to the rescue since balance < 1 SOL"),t.next=9,n.requestAirdrop(r,10*c.c);case 9:return o=t.sent,t.next=12,n.confirmTransaction(o);case 12:return t.next=14,n.getBalance(r);case 14:m=t.sent,console.log("New balance for address "+r.toBase58()+" is "+m);case 16:return b=c.b.generate(),p=c.b.generate(),l=u.b.span,d=u.a.span,t.next=22,n.getMinimumBalanceForRentExemption(l);case 22:return f=t.sent,t.next=25,n.getMinimumBalanceForRentExemption(d);case 25:return O=t.sent,v=new c.i,t.next=29,n.getRecentBlockhash("max");case 29:return v.recentBlockhash=t.sent.blockhash,v.add(c.h.createAccount({fromPubkey:r,newAccountPubkey:b.publicKey,lamports:f,space:l,programId:u.c})),v.add(c.h.createAccount({fromPubkey:r,newAccountPubkey:p.publicKey,lamports:O,space:d,programId:u.c})),t.next=34,c.d.createWithSeed(b.publicKey,"deliberatively",s.a);case 34:return x=t.sent,v.add(c.h.createAccountWithSeed({fromPubkey:r,newAccountPubkey:x,basePubkey:b.publicKey,seed:"deliberatively",lamports:O,space:d,programId:s.a})),y=b.publicKey.toString(),t.next=39,c.d.createWithSeed(r,"deliberatively"+y.slice(y.length-8),s.a);case 39:return g=t.sent,v.add(c.h.createAccountWithSeed({fromPubkey:r,newAccountPubkey:g,basePubkey:r,seed:"deliberatively"+y.slice(y.length-8),lamports:O,space:d,programId:s.a})),t.next=43,c.d.findProgramAddress([e.from("deliberatively","utf8"),b.publicKey.toBuffer()],s.a);case 43:return P=t.sent,v.add(u.d.createInitMintInstruction(u.c,b.publicKey,2,P[0],P[0])),v.add(u.d.createInitAccountInstruction(u.c,b.publicKey,p.publicKey,r)),t.abrupt("return",{transaction:v,deliberativelyMintDerivedAccountPubkey:x,initializerMintDerivedAccountPubkey:g,initializerTokenAccount:p,mintAccount:b,pda:P[0]});case 49:throw t.prev=49,t.t0=t.catch(0),console.log(t.t0),t.t0;case 53:case"end":return t.stop()}}),t,null,[[0,49]])})));return function(e,n){return t.apply(this,arguments)}}()}).call(this,n(11).Buffer)},597:function(e,t,n){"use strict";n.r(t);var r=n(576),i=n(12),a=n(14),u=n(1),c=n(596),s=Object(i.a)(c.a)((function(){return{userSelect:"none"}})),o=n(4),m={numberOfParticipants:5,maximumNumberOfRepresentatives:2,numberOfDays:1,minimumContributionRequiredFromParticipant:.1,setNumberOfParticipants:function(e){console.log(e)},setMaximumNumberOfRepresentatives:function(e){console.log(e)},setNumberOfDays:function(e){console.log(e)},setMinimumContributionRequiredFromParticipant:function(e){console.log(e)}},b=Object(u.createContext)(m),p=function(e){var t=e.children,n=Object(u.useState)(5),r=Object(a.a)(n,2),i=r[0],c=r[1],s=Object(u.useState)(2),m=Object(a.a)(s,2),p=m[0],l=m[1],d=Object(u.useState)(1),f=Object(a.a)(d,2),O=f[0],v=f[1],x=Object(u.useState)(.1),y=Object(a.a)(x,2),g=y[0],P=y[1];return Object(o.jsx)(b.Provider,{value:{numberOfParticipants:i,maximumNumberOfRepresentatives:p,numberOfDays:O,minimumContributionRequiredFromParticipant:g,setNumberOfParticipants:c,setMaximumNumberOfRepresentatives:l,setNumberOfDays:v,setMinimumContributionRequiredFromParticipant:P},children:t})},l=function(){return Object(u.useContext)(b)},d=function(){var e=l().setNumberOfParticipants,t=Object(u.useState)(5),n=Object(a.a)(t,2),r=n[0],i=n[1];return Object(o.jsx)(s,{variant:"outlined",id:"no_of_participants_textfield",type:"number",inputProps:{inputMode:"numeric",pattern:"[0-9]*"},label:"Participants",InputLabelProps:{shrink:!0},helperText:"Equals to maximum issued tokens",InputProps:{inputProps:{min:5,max:1e10}},value:r,onChange:function(t){if(t&&t.target&&t.target.value){var n,r=t.target.value.replace(/\D/g,"");""===r&&(n=5),n=(n=Number(r))<5?5:n<=1e10?Math.round(n):1e10,i(n),e(n)}}})},f=function(){var e=l().setNumberOfDays,t=Object(u.useState)(1),n=Object(a.a)(t,2),r=n[0],i=n[1];return Object(o.jsx)(s,{variant:"outlined",id:"no_of_days_textfield",type:"number",inputProps:{inputMode:"numeric",pattern:"[0-9]*"},label:"Number of days",InputLabelProps:{shrink:!0},helperText:"Representatives can start proposing alternatives afterwards",InputProps:{inputProps:{min:1,max:1e4}},value:r,onChange:function(t){if(t&&t.target&&t.target.value){var n,r=t.target.value.replace(/\D/g,"");""===r&&(n=1),n=(n=Number(r))<1?1:n<=1e4?Math.round(n):1e4,i(n),e(n)}}})},O=function(){var e=l(),t=e.numberOfParticipants,n=e.setMaximumNumberOfRepresentatives,r=Object(u.useState)(2),i=Object(a.a)(r,2),c=i[0],m=i[1];return Object(o.jsx)(s,{variant:"outlined",id:"no_of_representatives_textfield",type:"number",inputProps:{inputMode:"numeric",pattern:"[0-9]*"},label:"Maximum number of representatives",InputLabelProps:{shrink:!0},helperText:"Representatives need to have at least power > 1",InputProps:{inputProps:{min:2,max:Math.round(t/5)}},value:c,onChange:function(e){if(e&&e.target&&e.target.value){var r,i=e.target.value.replace(/\D/g,"");""===i&&(r=2),(r=Number(i))<2?r=2:r>t&&(r=Math.round(t/5)),m(r),n(r)}}})},v=n(2),x=n.n(v),y=n(7),g=n(34),P=n(68),j=n(10),h=n(18),k=n(19),R=n(574),A=n(27),S=n(583),N=n(575),w=function(e){Object(h.a)(n,e);var t=Object(k.a)(n);function n(e){var r;return Object(j.a)(this,n),(r=t.call(this,e)).instruction=N.b.InitVoteMarket,r.numberOfParticipants=5,r.maximumNumberOfRepresentatives=2,r.numberOfDays=1,r.minimumContributionRequiredFromParticipant=1e3,r.instruction=N.b.InitVoteMarket,r.numberOfParticipants=e.numberOfParticipants,r.maximumNumberOfRepresentatives=e.maximumNumberOfRepresentatives,r.numberOfDays=e.numberOfDays,r.minimumContributionRequiredFromParticipant=e.minimumContributionRequiredFromParticipant,r}return n}(A.g);A.e.set(w,{kind:"struct",fields:[["instruction","u8"],["numberOfParticipants","u32"],["maximumNumberOfRepresentatives","u32"],["numberOfDays","u16"],["minimumContributionRequiredFromParticipant","u32"]]});var M=function(){var e=Object(y.a)(x.a.mark((function e(t,n,r,i){var a,u,c,s,o,m,b,p,l,d,f,O;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(S.a)(t,n);case 2:return a=e.sent,u=a.transaction,c=a.deliberativelyMintDerivedAccountPubkey,s=a.initializerMintDerivedAccountPubkey,o=a.initializerTokenAccount,m=a.mintAccount,b=a.pda,p=new w({numberOfParticipants:i.numberOfParticipants,maximumNumberOfRepresentatives:i.maximumNumberOfRepresentatives,numberOfDays:i.numberOfDays,minimumContributionRequiredFromParticipant:i.minimumContributionRequiredFromParticipant}),l=p.encode(),d=new A.j({programId:N.a,keys:[{pubkey:n,isSigner:!0,isWritable:!1},{pubkey:m.publicKey,isSigner:!1,isWritable:!1},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:o.publicKey,isSigner:!1,isWritable:!1},{pubkey:b,isSigner:!1,isWritable:!1},{pubkey:A.f,isSigner:!1,isWritable:!1},{pubkey:R.c,isSigner:!1,isWritable:!1}],data:l}),u.add(d),u.feePayer=n,f=[m,o],u.partialSign.apply(u,f),e.next=18,r(u,t);case 18:return O=e.sent,e.next=21,t.confirmTransaction(O,"processed");case 21:return e.abrupt("return",{mintAccountPublicKey:m.publicKey,initializerTokenAccountPublicKey:o.publicKey,pda:b});case 22:case"end":return e.stop()}}),e)})));return function(t,n,r,i){return e.apply(this,arguments)}}(),D=n(79),C=n(36),I=n(216),K=function(){var e=l(),t=e.numberOfParticipants,n=e.numberOfDays,r=e.maximumNumberOfRepresentatives,i=e.minimumContributionRequiredFromParticipant,a=Object(P.c)().connection,c=Object(P.d)(),s=c.connected,m=c.wallet,b=c.publicKey,p=c.sendTransaction,d=Object(g.f)(),f=Object(u.useMemo)((function(){return{numberOfParticipants:t,numberOfDays:n,maximumNumberOfRepresentatives:r,minimumContributionRequiredFromParticipant:i}}),[t,n,r,i]),O=Object(u.useCallback)(Object(y.a)(x.a.mark((function e(){var u,c,o,l,O,v;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s&&m&&b){e.next=3;break}return console.log("No wallet found"),e.abrupt("return");case 3:return e.prev=3,e.next=6,M(a,b,p,f);case 6:return u=e.sent,c=u.mintAccountPublicKey,o=u.initializerTokenAccountPublicKey,l=u.pda,e.next=12,Object(C.e)(c.toString());case 12:return O=e.sent,v={address:c.toString(),hash:O,numberOfParticipants:t,minimumContributionRequiredFromParticipant:i,maxRepresentatives:r,startDate:Date.now(),stopDate:Date.now()+864e5*n,pda:l.toString(),ownTokenAddress:o.toString(),participants:[],alternatives:[]},e.next=16,Object(D.e)(v);case 16:d.push("/market/".concat(c.toString())),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(3),console.log(e.t0);case 22:case"end":return e.stop()}}),e,null,[[3,19]])}))),[s,m,b]);return Object(o.jsx)(I.a,{disableRipple:!0,onClick:O,children:"MINT"})},q=Object(i.a)(r.a)((function(e){var t=e.theme;return{padding:t.spacing(2),marginTop:t.spacing(2),marginLeft:t.spacing(3),backgroundColor:t.palette.background.paper}})),F=Object(i.a)(r.a)((function(e){return{padding:e.theme.spacing(3),textAlign:"center",justifyContent:"space-evenly"}}));t.default=function(){return Object(o.jsx)(p,{children:Object(o.jsxs)(q,{container:!0,rowSpacing:{xs:2,sm:3,md:4},columnSpacing:{xs:2,sm:3,md:4},columns:{xs:1,sm:4,md:8},direction:{xs:"column",sm:"row"},children:[Object(o.jsx)(q,{item:!0,xs:1,sm:4,md:8,children:Object(o.jsx)(d,{})}),Object(o.jsx)(q,{item:!0,xs:1,sm:4,md:8,children:Object(o.jsx)(f,{})}),Object(o.jsx)(q,{item:!0,xs:1,sm:4,md:8,children:Object(o.jsx)(O,{})}),Object(o.jsx)(F,{item:!0,xs:1,sm:4,md:8,children:Object(o.jsx)(K,{})})]})})}}}]);
//# sourceMappingURL=4.62a5300e.chunk.js.map